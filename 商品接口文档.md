# 实体商品管理接口文档

**基础路径**：`/api/admin/platform/physical-product`

**说明**：本接口用于管理实体商品（productType=1），与课程管理（productType=0）独立区分。

**数据隔离机制**：
- ✅ 所有查询自动过滤：`productType = 1`（实体商品）
- ✅ 所有更新自动校验：只允许操作实体商品
- ✅ 防止误操作课程数据：后端自动识别并拒绝非实体商品操作
- ✅ 统计数据独立计算：课程和商品统计互不影响

---

## 1. 商品列表查询

### 接口信息
- **URL**：`GET /api/admin/platform/physical-product/list`
- **说明**：分页查询实体商品列表，支持多条件筛选和排序

### 请求参数

| 参数名 | 类型 | 必填 | 默认值 | 说明 | 示例值 |
|--------|------|------|--------|------|--------|
| page | Integer | 否 | 1 | 当前页码，从1开始 | 1 |
| limit | Integer | 否 | 20 | 每页显示数量，建议10-100 | 20 |
| name | String | 否 | - | 商品名称，支持模糊查询 | "迪士尼T恤" |
| categoryId | Integer | 否 | - | 平台分类ID，精确匹配 | 7 |
| isShow | Boolean | 否 | - | 是否上架：true-已上架，false-未上架 | true |
| auditStatus | Integer | 否 | - | 审核状态：0-无需审核，1-待审核，2-审核通过，3-审核拒绝 | 2 |
| priceMin | String | 否 | - | 最低价格，支持小数，单位：元 | "10.00" |
| priceMax | String | 否 | - | 最高价格，支持小数，单位：元 | "500.00" |
| sortField | String | 否 | create_time | 排序字段：sales-销量，price-价格，create_time-创建时间 | "sales" |
| sortOrder | String | 否 | desc | 排序方式：asc-升序，desc-降序 | "desc" |

### 响应参数

**成功响应（code=200）**

```json
{
  "code": 200,
  "message": "成功",
  "data": {
    "list": [
      {
        "id": 94,                           // 商品ID
        "productType": 1,                   // 产品类型：1-实体商品
        "name": "迪士尼联名T恤",              // 商品名称
        "image": "https://cdn.example.com/product/main.jpg",  // 主图
        "sliderImage": "https://...,https://...",  // 轮播图，逗号分隔
        "price": 109.00,                    // 商品价格（最低SKU价格）
        "otPrice": 200.00,                  // 市场价/原价
        "stock": 180,                       // 总库存（所有SKU之和）
        "sales": 256,                       // 销量
        "ficti": 100,                       // 虚拟销量
        "unitName": "件",                   // 单位
        "categoryId": 7,                    // 平台分类ID
        "brandId": 32,                      // 品牌ID
        "isShow": true,                     // 是否上架
        "auditStatus": 2,                   // 审核状态
        "type": 0,                          // 基础类型
        "createTime": "2024-07-01 10:00:00",  // 创建时间
        "updateTime": "2024-07-15 14:30:00"   // 更新时间
      }
    ],
    "total": 100,      // 总记录数
    "pageNum": 1,      // 当前页码
    "pageSize": 20     // 每页数量
  }
}
```

---

## 2. 商品详情

### 接口信息
- **URL**：`GET /api/admin/platform/physical-product/detail/{id}`
- **说明**：获取指定商品的详细信息，包括商品描述

### 路径参数

| 参数名 | 类型 | 必填 | 说明 | 示例值 |
|--------|------|------|------|--------|
| id | Integer | 是 | 商品ID | 94 |

### 响应参数

**成功响应（code=200）**

```json
{
  "code": 200,
  "message": "成功",
  "data": {
    "id": 94,
    "productType": 1,                  // 产品类型：1-实体商品
    "type": 0,                         // 基础类型：0-普通商品
    "image": "https://cdn.example.com/product/main.jpg",
    "flatPattern": "https://cdn.example.com/product/flat.jpg",  // 展示图
    "sliderImage": "https://...,https://...,https://...",       // 轮播图
    "name": "迪士尼联名T恤",
    "intro": "高品质纯棉材质，迪士尼正版授权",                    // 商品简介
    "keyword": "迪士尼,T恤,联名",                                 // 关键词
    "cateId": "1,2",                   // 商户分类ID（逗号分隔）
    "brandId": 32,                     // 品牌ID
    "categoryId": 7,                   // 平台分类ID
    "guaranteeIds": "1,2,3",           // 保障服务IDs（逗号分隔）
    "price": 109.00,                   // 商品价格
    "vipPrice": 99.00,                 // 会员价格
    "otPrice": 200.00,                 // 市场价
    "stock": 180,                      // 库存
    "sales": 256,                      // 销量
    "ficti": 100,                      // 虚拟销量
    "cost": 50.00,                     // 成本价
    "unitName": "件",                  // 单位
    "tempId": 1,                       // 运费模板ID
    "sort": 100,                       // 排序值，越大越靠前
    "specType": true,                  // 规格类型：false-单规格，true-多规格
    "isShow": true,                    // 是否上架
    "auditStatus": 2,                  // 审核状态
    "isSub": false,                    // 是否单独分佣
    "isPaidMember": false,             // 是否付费会员商品
    "deliveryMethod": "1",             // 配送方式：1-商家配送，2-到店核销
    "refundSwitch": true,              // 是否支持退款
    "isHot": 1,                        // 是否热门推荐：0-否，1-是
    "redeemIntegral": 0,               // 兑换积分
    "content": "<p>商品详情HTML内容...</p>",  // 商品详情（富文本）
    "createTime": "2024-07-01 10:00:00",
    "updateTime": "2024-07-15 14:30:00"
  }
}
```

**失败响应**

```json
{
  "code": 400,
  "message": "商品不存在或不是实体商品",
  "data": null
}
```

---

## 3. 创建商品

### 接口信息
- **URL**：`POST /api/admin/platform/physical-product/create`
- **Content-Type**：`application/json`
- **说明**：创建新的实体商品，包括基本信息、规格、SKU等

### 请求参数

**基本信息**

| 参数名 | 类型 | 必填 | 说明 | 示例值 |
|--------|------|------|------|--------|
| image | String | 是 | 商品主图URL，最多255字符 | "https://cdn.example.com/main.jpg" |
| flatPattern | String | 否 | 展示图URL，最多1000字符 | "https://cdn.example.com/flat.jpg" |
| sliderImage | String | 是 | 轮播图URLs，逗号分隔，最多2000字符 | "https://...,https://..." |
| name | String | 是 | 商品名称，最多50字符 | "迪士尼联名T恤" |
| intro | String | 是 | 商品简介，最多100字符 | "高品质纯棉材质" |
| keyword | String | 否 | 搜索关键词，逗号分隔 | "迪士尼,T恤,联名" |
| cateId | String | 是 | 商户分类IDs，逗号分隔，最多64字符 | "1,2" |
| unitName | String | 是 | 商品单位，最多32字符 | "件" |
| tempId | Integer | 是 | 运费模板ID | 1 |
| sort | Integer | 否 | 排序值，越大越靠前，默认0 | 100 |
| specType | Boolean | 是 | 规格类型：false-单规格，true-多规格 | true |
| isPaidMember | Boolean | 是 | 是否付费会员商品，默认false | false |
| isAutoUp | Boolean | 否 | 是否自动上架，默认false | false |
| deliveryMethod | String | 是 | 配送方式：1-商家配送，2-到店核销，多个逗号分隔 | "1" |
| refundSwitch | Boolean | 否 | 是否支持退款，默认false | false |
| systemFormId | Integer | 否 | 系统表单ID，默认0 | 0 |
| isHot | Integer | 否 | 是否热门推荐：0-否，1-是，默认0 | 0 |
| redeemIntegral | Integer | 否 | 兑换积分，默认0 | 0 |
| content | String | 否 | 商品详情（富文本HTML） | "<p>详细介绍...</p>" |

**规格信息（attrList）**

商品规格数组，每个规格对象包含：

| 参数名 | 类型 | 必填 | 说明 | 示例值 |
|--------|------|------|------|--------|
| attributeName | String | 是 | 规格名称，如"颜色"、"尺码" | "颜色" |
| isShowImage | Boolean | 否 | 是否显示规格图片 | true |
| optionList | Array | 是 | 规格选项数组，见下表 | [...] |

**规格选项（optionList）**

每个规格选项对象包含：

| 参数名 | 类型 | 必填 | 说明 | 示例值 |
|--------|------|------|------|--------|
| optionName | String | 是 | 选项名称 | "米白色" |
| image | String | 否 | 选项图片URL | "https://..." |

**SKU信息（attrValueList）**

商品SKU数组，每个SKU对象包含：

| 参数名 | 类型 | 必填 | 说明 | 示例值 |
|--------|------|------|------|--------|
| stock | Integer | 是 | 库存数量，最小0 | 30 |
| price | BigDecimal | 是 | 售价，0-999999.99 | 109.00 |
| image | String | 是 | SKU图片URL | "https://..." |
| cost | BigDecimal | 是 | 成本价，0-999999.99 | 50.00 |
| otPrice | BigDecimal | 是 | 市场价/原价，0-999999.99 | 200.00 |
| weight | BigDecimal | 是 | 重量（kg），最小0 | 0.3 |
| volume | BigDecimal | 是 | 体积（m³），最小0 | 0.01 |
| attrValue | String | 是 | 规格属性JSON，格式：{"规格名":"选项名"} | "{\"颜色\":\"米白色\",\"尺码\":\"S\"}" |
| barCode | String | 否 | 商品条码 | "6901234567890" |
| isDefault | Boolean | 否 | 是否默认SKU | true |

### 请求示例

```json
{
  "image": "https://cdn.example.com/main.jpg",
  "flatPattern": "https://cdn.example.com/flat.jpg",
  "sliderImage": "https://cdn.example.com/1.jpg,https://cdn.example.com/2.jpg,https://cdn.example.com/3.jpg",
  "name": "迪士尼联名T恤",
  "intro": "高品质纯棉材质，迪士尼正版授权",
  "keyword": "迪士尼,T恤,联名",
  "cateId": "1,2",
  "unitName": "件",
  "tempId": 1,
  "sort": 100,
  "specType": true,
  "isPaidMember": false,
  "isAutoUp": false,
  "deliveryMethod": "1",
  "refundSwitch": false,
  "systemFormId": 0,
  "isHot": 0,
  "redeemIntegral": 0,
  "attrList": [
    {
      "attributeName": "颜色",
      "isShowImage": true,
      "optionList": [
        {
          "optionName": "米白色",
          "image": "https://cdn.example.com/white.jpg"
        },
        {
          "optionName": "黑色",
          "image": "https://cdn.example.com/black.jpg"
        }
      ]
    },
    {
      "attributeName": "尺码",
      "isShowImage": false,
      "optionList": [
        {"optionName": "S"},
        {"optionName": "M"},
        {"optionName": "L"}
      ]
    }
  ],
  "attrValueList": [
    {
      "stock": 30,
      "price": 109.00,
      "image": "https://cdn.example.com/white-s.jpg",
      "cost": 50.00,
      "otPrice": 200.00,
      "weight": 0.3,
      "volume": 0.01,
      "attrValue": "{\"颜色\":\"米白色\",\"尺码\":\"S\"}",
      "barCode": "6901234567890",
      "isDefault": true
    },
    {
      "stock": 30,
      "price": 109.00,
      "image": "https://cdn.example.com/white-m.jpg",
      "cost": 50.00,
      "otPrice": 200.00,
      "weight": 0.3,
      "volume": 0.01,
      "attrValue": "{\"颜色\":\"米白色\",\"尺码\":\"M\"}",
      "barCode": ""
    }
  ],
  "content": "<p>商品详情HTML内容...</p>"
}
```

### 响应参数

**成功响应（code=200）**

```json
{
  "code": 200,
  "message": "商品创建成功",
  "data": null
}
```

**失败响应**

```json
{
  "code": 400,
  "message": "商品创建失败",
  "data": null
}
```

---

## 4. 更新商品

### 接口信息
- **URL**：`POST /api/admin/platform/physical-product/update`
- **Content-Type**：`application/json`
- **说明**：更新已存在的实体商品信息，只需传递要更新的字段

### 请求参数

| 参数名 | 类型 | 必填 | 说明 | 示例值 |
|--------|------|------|------|--------|
| id | Integer | 是 | 商品ID | 94 |
| image | String | 否 | 商品主图URL | "https://..." |
| flatPattern | String | 否 | 展示图URL | "https://..." |
| sliderImage | String | 否 | 轮播图URLs | "https://...,https://..." |
| name | String | 否 | 商品名称 | "迪士尼联名T恤（新款）" |
| intro | String | 否 | 商品简介 | "更新的简介" |
| keyword | String | 否 | 关键词 | "迪士尼,T恤" |
| cateId | String | 否 | 商户分类IDs | "1,2" |
| unitName | String | 否 | 单位名 | "件" |
| tempId | Integer | 否 | 运费模板ID | 1 |
| sort | Integer | 否 | 排序值 | 100 |
| specType | Boolean | 否 | 规格类型 | true |
| isPaidMember | Boolean | 否 | 是否付费会员商品 | false |
| deliveryMethod | String | 否 | 配送方式 | "1" |
| refundSwitch | Boolean | 否 | 是否支持退款 | false |
| systemFormId | Integer | 否 | 系统表单ID | 0 |
| isHot | Integer | 否 | 是否热门推荐 | 1 |
| redeemIntegral | Integer | 否 | 兑换积分 | 0 |
| attrList | Array | 否 | 商品规格数组（提供则全量替换） | [...] |
| attrValueList | Array | 否 | 商品SKU数组（提供则全量替换） | [...] |
| content | String | 否 | 商品详情 | "<p>...</p>" |

**说明**：
- 只需传递需要更新的字段，未传递的字段保持不变
- 如果传递了`attrList`或`attrValueList`，系统会删除原有数据并保存新数据（全量替换）
- 规格和SKU的数据结构与创建接口相同

### 请求示例

```json
{
  "id": 94,
  "name": "迪士尼联名T恤（新款）",
  "intro": "更新后的商品简介",
  "sort": 200,
  "isHot": 1
}
```

### 响应参数

**成功响应（code=200）**

```json
{
  "code": 200,
  "message": "商品更新成功",
  "data": null
}
```

**失败响应**

```json
{
  "code": 400,
  "message": "商品不存在或不是实体商品",
  "data": null
}
```

---

## 5. 删除商品

### 接口信息
- **URL**：`POST /api/admin/platform/physical-product/delete/{id}`
- **说明**：软删除商品，不会真正删除数据，只是标记为已删除

### 路径参数

| 参数名 | 类型 | 必填 | 说明 | 示例值 |
|--------|------|------|------|--------|
| id | Integer | 是 | 商品ID | 94 |

### 响应参数

**成功响应（code=200）**

```json
{
  "code": 200,
  "message": "商品删除成功",
  "data": null
}
```

**失败响应**

```json
{
  "code": 400,
  "message": "商品不存在或不是实体商品",
  "data": null
}
```

---

## 6. 批量删除商品

### 接口信息
- **URL**：`POST /api/admin/platform/physical-product/batch/delete`
- **Content-Type**：`application/json`
- **说明**：批量软删除多个商品

### 请求参数

**请求体**：商品ID数组

```json
[94, 95, 96, 97]
```

### 响应参数

**成功响应（code=200）**

```json
{
  "code": 200,
  "message": "批量删除成功",
  "data": null
}
```

**失败响应**

```json
{
  "code": 400,
  "message": "请选择要删除的商品",
  "data": null
}
```

---

## 7. 上架商品

### 接口信息
- **URL**：`POST /api/admin/platform/physical-product/on-shelf/{id}`
- **说明**：将商品设置为上架状态，前台可见

### 路径参数

| 参数名 | 类型 | 必填 | 说明 | 示例值 |
|--------|------|------|------|--------|
| id | Integer | 是 | 商品ID | 94 |

### 响应参数

**成功响应（code=200）**

```json
{
  "code": 200,
  "message": "商品上架成功",
  "data": null
}
```

---

## 8. 下架商品

### 接口信息
- **URL**：`POST /api/admin/platform/physical-product/off-shelf/{id}`
- **说明**：将商品设置为下架状态，前台不可见

### 路径参数

| 参数名 | 类型 | 必填 | 说明 | 示例值 |
|--------|------|------|------|--------|
| id | Integer | 是 | 商品ID | 94 |

### 响应参数

**成功响应（code=200）**

```json
{
  "code": 200,
  "message": "商品下架成功",
  "data": null
}
```

---

## 9. 获取商品规格列表

### 接口信息
- **URL**：`GET /api/admin/platform/physical-product/attr/{productId}`
- **说明**：获取指定商品的所有规格信息

### 路径参数

| 参数名 | 类型 | 必填 | 说明 | 示例值 |
|--------|------|------|------|--------|
| productId | Integer | 是 | 商品ID | 94 |

### 响应参数

**成功响应（code=200）**

```json
{
  "code": 200,
  "message": "成功",
  "data": [
    {
      "id": 1,                    // 规格ID
      "productId": 94,            // 商品ID
      "attributeName": "颜色",     // 规格名称
      "isShowImage": true,        // 是否显示图片
      "sort": 0                   // 排序值
    },
    {
      "id": 2,
      "productId": 94,
      "attributeName": "尺码",
      "isShowImage": false,
      "sort": 1
    }
  ]
}
```

---

## 10. 获取商品SKU列表

### 接口信息
- **URL**：`GET /api/admin/platform/physical-product/sku/{productId}`
- **说明**：获取指定商品的所有SKU信息

### 路径参数

| 参数名 | 类型 | 必填 | 说明 | 示例值 |
|--------|------|------|------|--------|
| productId | Integer | 是 | 商品ID | 94 |

### 响应参数

**成功响应（code=200）**

```json
{
  "code": 200,
  "message": "成功",
  "data": [
    {
      "id": 2430,                                    // SKU ID
      "productId": 94,                               // 商品ID
      "sku": "{\"颜色\":\"米白色\",\"尺码\":\"S\"}",    // SKU标识（规格属性JSON）
      "stock": 30,                                   // 库存
      "sales": 12,                                   // 销量
      "price": 109.00,                               // 售价
      "vipPrice": 99.00,                             // 会员价
      "image": "https://cdn.example.com/sku1.jpg",   // SKU图片
      "cost": 50.00,                                 // 成本价
      "barCode": "6901234567890",                    // 商品条码
      "otPrice": 200.00,                             // 市场价
      "weight": 0.30,                                // 重量（kg）
      "volume": 0.01,                                // 体积（m³）
      "brokerage": 5.00,                             // 一级返佣金额
      "brokerageTwo": 2.00,                          // 二级返佣金额
      "attrValue": "{\"颜色\":\"米白色\",\"尺码\":\"S\"}",  // 规格属性（与sku相同）
      "isShow": true,                                // 是否显示
      "isDefault": true                              // 是否默认SKU
    },
    {
      "id": 2431,
      "productId": 94,
      "sku": "{\"颜色\":\"米白色\",\"尺码\":\"M\"}",
      "stock": 25,
      "sales": 18,
      "price": 109.00,
      "vipPrice": 99.00,
      "image": "https://cdn.example.com/sku2.jpg",
      "cost": 50.00,
      "barCode": "",
      "otPrice": 200.00,
      "weight": 0.30,
      "volume": 0.01,
      "brokerage": 5.00,
      "brokerageTwo": 2.00,
      "attrValue": "{\"颜色\":\"米白色\",\"尺码\":\"M\"}",
      "isShow": true,
      "isDefault": false
    }
  ]
}
```

---

## 11. 商品统计

### 接口信息
- **URL**：`GET /api/admin/platform/physical-product/stats`
- **说明**：获取实体商品的统计数据

### 响应参数

**成功响应（code=200）**

```json
{
  "code": 200,
  "message": "成功",
  "data": {
    "total": 100,      // 总商品数（不含已删除）
    "onShelf": 75,     // 已上架商品数
    "offShelf": 25,    // 已下架商品数
    "pending": 5       // 待审核商品数
  }
}
```

---

## 通用说明

### 错误码

| 错误码 | 说明 |
|--------|------|
| 200 | 成功 |
| 400 | 请求参数错误或业务逻辑错误 |
| 401 | 未授权，需要登录 |
| 403 | 无权限访问 |
| 404 | 资源不存在 |
| 500 | 服务器内部错误 |

### 数据类型说明

- **Integer**：整数类型
- **String**：字符串类型
- **Boolean**：布尔类型，true/false
- **BigDecimal**：高精度数字类型，用于金额、重量等
- **Array**：数组类型
- **Date**：日期时间类型，格式：`yyyy-MM-dd HH:mm:ss`

### 注意事项

1. **商品类型区分与数据隔离**：
   - `productType=1` 表示实体商品
   - `productType=0` 表示课程
   - **本接口只能操作实体商品**
   - **所有查询都自动过滤 `productType=1`**，确保不会误查询到课程数据
   - **所有修改操作都先校验商品类型**，防止误修改课程
   - **批量操作会自动跳过非实体商品**，只处理符合条件的数据

2. **规格和SKU**：
   - 单规格商品：`specType=false`，只有一个默认SKU
   - 多规格商品：`specType=true`，有多个规格和SKU
   - SKU的`attrValue`字段存储JSON格式的规格组合

3. **库存和价格计算**：
   - 商品的总库存 = 所有SKU的库存之和
   - 商品的显示价格 = 所有SKU中的最低价格

4. **图片URL**：
   - 所有图片字段需要提供完整的URL地址
   - 轮播图使用英文逗号`,`分隔多个URL
   - 建议使用CDN加速

5. **软删除**：
   - 删除操作不会真正删除数据
   - 只是将`isDel`字段标记为`true`
   - 已删除的商品不会出现在列表查询中

6. **审核流程**：
   - 新创建的商品默认`auditStatus=1`（待审核）
   - 需要审核通过后才能上架
   - 可通过`auditStatus`字段查询不同审核状态的商品

7. **分页查询**：
   - 建议`limit`设置在10-100之间
   - `page`从1开始计数
   - 响应中的`total`表示符合条件的总记录数

8. **价格精度**：
   - 所有价格相关字段使用`BigDecimal`类型
   - 支持2位小数
   - 范围：0.00 - 999999.99

9. **商品分类**：
   - 商品分类使用商户商品分类（`MerchantProductCategory`）
   - 分类支持树形结构，通过`pid`字段关联父分类
   - `cateId`字段存储商品关联的分类ID，多个分类使用逗号分隔

10. **数据安全保障**：
   - ⚠️ **重要**：由于课程和商品共用`eb_product`表
   - 后端已在所有查询和操作中自动添加`productType=1`的过滤条件
   - 前端无需担心数据混淆，所有接口都已做好数据隔离
   - 批量操作（删除、上下架、排序）会自动跳过非实体商品
   - 单个商品操作（详情、修改、删除）会先校验商品类型，如果不是实体商品会抛出异常

---

## 17. 批量上架商品

### 接口信息
- **URL**：`POST /api/admin/platform/physical-product/batch/on-shelf`
- **Content-Type**：`application/json`
- **说明**：批量上架多个商品，提升运营效率

### 请求参数

**请求体**：商品ID数组

```json
[94, 95, 96, 97, 98]
```

### 响应参数

**成功响应（code=200）**

```json
{
  "code": 200,
  "message": "批量上架成功",
  "data": null
}
```

**失败响应**

```json
{
  "code": 400,
  "message": "商品ID:95 不是实体商品",
  "data": null
}
```

---

## 18. 批量下架商品

### 接口信息
- **URL**：`POST /api/admin/platform/physical-product/batch/off-shelf`
- **Content-Type**：`application/json`
- **说明**：批量下架多个商品

### 请求参数

**请求体**：商品ID数组

```json
[94, 95, 96]
```

### 响应参数

**成功响应（code=200）**

```json
{
  "code": 200,
  "message": "批量下架成功",
  "data": null
}
```

---

## 19. 快速调整SKU库存

### 接口信息
- **URL**：`POST /api/admin/platform/physical-product/stock/quick-adjust`
- **Content-Type**：`application/x-www-form-urlencoded`
- **说明**：快速增加或减少指定SKU的库存，无需完整更新商品

### 请求参数

| 参数名 | 类型 | 必填 | 说明 | 示例值 |
|--------|------|------|------|--------|
| productId | Integer | 是 | 商品ID | 94 |
| skuId | Integer | 是 | SKU ID | 2430 |
| quantity | Integer | 是 | 调整数量（正数增加，负数减少） | 10 或 -5 |

**说明**：
- `quantity`为正数时增加库存，为负数时减少库存
- 减少库存时会检查库存是否充足
- 会自动重新计算商品总库存

### 请求示例

```
POST /api/admin/platform/physical-product/stock/quick-adjust?productId=94&skuId=2430&quantity=10
```

### 响应参数

**成功响应（code=200）**

```json
{
  "code": 200,
  "message": "库存调整成功",
  "data": null
}
```

**失败响应**

```json
{
  "code": 400,
  "message": "库存不足，无法减少5件",
  "data": null
}
```

---

## 20. 批量更新商品排序

### 接口信息
- **URL**：`POST /api/admin/platform/physical-product/sort`
- **Content-Type**：`application/json`
- **说明**：批量调整商品显示顺序，排序值越大越靠前

### 请求参数

**请求体**：商品ID和排序值的映射对象

```json
{
  "94": 100,
  "95": 200,
  "96": 150,
  "97": 50
}
```

**说明**：
- Key为商品ID（String类型）
- Value为排序值（Integer类型）
- 排序值越大，商品在列表中越靠前

### 响应参数

**成功响应（code=200）**

```json
{
  "code": 200,
  "message": "排序更新成功",
  "data": null
}
```

---

## 21. 商品销售排行

### 接口信息
- **URL**：`GET /api/admin/platform/physical-product/sales-rank`
- **说明**：获取商品销售排行榜，支持按销量或销售额排序

### 请求参数

| 参数名 | 类型 | 必填 | 默认值 | 说明 | 示例值 |
|--------|------|------|--------|------|--------|
| startDate | String | 否 | - | 开始日期（暂未实现时间过滤） | "2024-01-01" |
| endDate | String | 否 | - | 结束日期（暂未实现时间过滤） | "2024-01-31" |
| orderBy | String | 否 | sales | 排序依据：sales-销量，amount-销售额 | "sales" |
| limit | Integer | 否 | 10 | 返回TOP数量 | 20 |

**说明**：
- 当前版本基于商品表的累计销量统计
- 未来版本可结合订单表实现时间范围内的销售统计

### 响应参数

**成功响应（code=200）**

```json
{
  "code": 200,
  "message": "成功",
  "data": [
    {
      "rank": 1,                          // 排名
      "productId": 94,                    // 商品ID
      "productName": "迪士尼联名T恤",       // 商品名称
      "image": "https://...",             // 商品主图
      "price": 109.00,                    // 商品价格
      "sales": 1256,                      // 销量
      "stock": 180,                       // 库存
      "amount": 136904.00                 // 销售额（价格×销量）
    },
    {
      "rank": 2,
      "productId": 95,
      "productName": "Nike运动鞋",
      "image": "https://...",
      "price": 599.00,
      "sales": 856,
      "stock": 45,
      "amount": 512744.00
    },
    {
      "rank": 3,
      "productId": 96,
      "productName": "Adidas运动包",
      "image": "https://...",
      "price": 299.00,
      "sales": 642,
      "stock": 120,
      "amount": 191958.00
    }
  ]
}
```

### 使用场景

1. **商品运营分析**
   - 查看哪些商品最受欢迎
   - 识别爆款商品

2. **库存管理决策**
   - 热销商品及时补货
   - 滞销商品考虑促销

3. **首页推荐**
   - 将热销商品推荐到首页
   - 提升转化率

---

# 商品分类管理接口

**说明**：商品分类管理支持树形结构，用于实体商品的分类组织。分为商户端和平台端两套接口。

## 分类接口分类

### **商户端分类接口**
- **基础路径**：`/api/admin/merchant/store/product/category`
- **用途**：商户管理自己的商品分类

### **平台端分类接口**
- **基础路径**：`/api/admin/platform/product/category`
- **用途**：平台管理全局商品分类

---

## 22. 分类列表（树形）

### 接口信息
- **商户端URL**：`GET /api/admin/merchant/store/product/category/list`
- **平台端URL**：`GET /api/admin/platform/product/category/list`
- **说明**：获取商品分类树形列表，包含所有层级

### 响应参数

**成功响应（code=200）**

```json
{
  "code": 200,
  "message": "成功",
  "data": [
    {
      "id": 1,                      // 分类ID
      "merId": 3,                   // 商户ID
      "pid": 0,                     // 父分类ID，0表示顶级分类
      "name": "服装鞋包",             // 分类名称
      "icon": "https://...",        // 分类图标URL
      "sort": 100,                  // 排序值，越大越靠前
      "isShow": true,               // 是否显示
      "createTime": "2024-01-01 10:00:00",
      "updateTime": "2024-01-15 14:30:00",
      "children": [                 // 子分类列表
        {
          "id": 2,
          "merId": 3,
          "pid": 1,
          "name": "T恤",
          "icon": "",
          "sort": 50,
          "isShow": true,
          "createTime": "2024-01-02 10:00:00",
          "updateTime": "2024-01-15 14:30:00",
          "children": []
        }
      ]
    }
  ]
}
```

---

## 23. 创建分类

### 接口信息
- **商户端URL**：`POST /api/admin/merchant/store/product/category/add`
- **平台端URL**：`POST /api/admin/platform/product/category/add`
- **Content-Type**：`application/json`
- **说明**：创建新的商品分类

### 请求参数

| 参数名 | 类型 | 必填 | 说明 | 示例值 |
|--------|------|------|------|--------|
| pid | Integer | 是 | 父分类ID，0表示创建顶级分类 | 1 |
| name | String | 是 | 分类名称，最多100字符 | "T恤" |
| icon | String | 否 | 分类图标URL，最多255字符 | "https://..." |
| sort | Integer | 否 | 排序值，越大越靠前，默认999 | 100 |
| isShow | Boolean | 否 | 是否显示，默认true | true |

### 请求示例

```json
{
  "pid": 1,
  "name": "T恤",
  "icon": "https://cdn.example.com/icon/tshirt.png",
  "sort": 50,
  "isShow": true
}
```

### 响应参数

**成功响应（code=200）**

```json
{
  "code": 200,
  "message": "分类创建成功",
  "data": null
}
```

---

## 24. 更新分类

### 接口信息
- **商户端URL**：`POST /api/admin/merchant/store/product/category/update`
- **平台端URL**：`POST /api/admin/platform/product/category/update`
- **Content-Type**：`application/json`
- **说明**：更新分类信息，只需传递要更新的字段

### 请求参数

| 参数名 | 类型 | 必填 | 说明 | 示例值 |
|--------|------|------|------|--------|
| id | Integer | 是 | 分类ID | 2 |
| pid | Integer | 否 | 父分类ID | 1 |
| name | String | 否 | 分类名称 | "长袖T恤" |
| icon | String | 否 | 分类图标URL | "https://..." |
| sort | Integer | 否 | 排序值 | 60 |
| isShow | Boolean | 否 | 是否显示 | true |

### 请求示例

```json
{
  "id": 2,
  "name": "长袖T恤",
  "sort": 60
}
```

### 响应参数

**成功响应（code=200）**

```json
{
  "code": 200,
  "message": "分类更新成功",
  "data": null
}
```

---

## 25. 删除分类

### 接口信息
- **商户端URL**：`POST /api/admin/merchant/store/product/category/delete/{id}`
- **平台端URL**：`POST /api/admin/platform/product/category/delete/{id}`
- **说明**：删除指定分类，如果有子分类则不允许删除

### 路径参数

| 参数名 | 类型 | 必填 | 说明 | 示例值 |
|--------|------|------|------|--------|
| id | Integer | 是 | 分类ID | 2 |

### 响应参数

**成功响应（code=200）**

```json
{
  "code": 200,
  "message": "分类删除成功",
  "data": null
}
```

**失败响应**

```json
{
  "code": 400,
  "message": "该分类下存在子分类，无法删除",
  "data": null
}
```

---

## 26. 显示/隐藏分类

### 接口信息
- **商户端URL**：`POST /api/admin/merchant/store/product/category/update/show/{id}`
- **平台端URL**：`POST /api/admin/platform/product/category/update/show/{id}`
- **说明**：切换分类的显示/隐藏状态

### 路径参数

| 参数名 | 类型 | 必填 | 说明 | 示例值 |
|--------|------|------|------|--------|
| id | Integer | 是 | 分类ID | 2 |

### 响应参数

**成功响应（code=200）**

```json
{
  "code": 200,
  "message": "状态更新成功",
  "data": null
}
```

---

## 27. 分类缓存树

### 接口信息
- **商户端URL**：`GET /api/admin/merchant/store/product/category/cache/tree`
- **平台端URL**：`GET /api/admin/platform/product/category/cache/tree`
- **说明**：获取商品分类缓存树，用于下拉选择等场景，性能更优

### 响应参数

**成功响应（code=200）**

```json
{
  "code": 200,
  "message": "成功",
  "data": [
    {
      "value": 1,                    // 分类ID
      "label": "服装鞋包",            // 分类名称
      "disabled": false,             // 是否禁用
      "children": [
        {
          "value": 2,
          "label": "T恤",
          "disabled": false,
          "children": []
        }
      ]
    }
  ]
}
```

### 使用场景
1. **商品编辑页面**：下拉选择商品分类
2. **筛选器**：分类筛选组件
3. **树形选择器**：级联选择分类

---

## 商品分类使用说明

### 分类层级
- 支持多级分类结构（通常为2-3级）
- 通过`pid`字段建立父子关系
- `pid=0`表示顶级分类

### 分类与商品关联
- 商品的`categoryId`字段存储关联的**平台分类ID**（单个）
- 商品的`cateId`字段存储关联的**商户分类ID**（多个，逗号分隔）
- 例如：`categoryId = 5` 表示平台分类，`cateId = "1,2"` 表示属于商户的多个分类

### 商户端 vs 平台端分类
- **商户分类**：商户自己定义的分类，仅在商户后台管理
- **平台分类**：平台统一的分类体系，用于平台级别的商品管理

### 注意事项
1. 删除分类前需要先删除该分类下的所有子分类
2. 删除分类前需要确保没有商品使用该分类
3. 隐藏的分类不会在前端显示，但不影响已关联的商品
4. 排序值越大，分类在列表中越靠前
5. 商户分类和平台分类相互独立，互不影响
